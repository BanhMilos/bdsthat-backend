generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                                          BigInt              @id @default(autoincrement())
  email                                       String              @unique @db.VarChar(255)
  passwordHash                                String              @map("password_hash") @db.VarChar(255)
  fullname                                    String?             @db.VarChar(255)
  phone                                       String?             @db.VarChar(20)
  address                                     String?
  idCardNumber                                String?             @map("id_card_number") @db.VarChar(50)
  idCardType                                  user_idcard_type?   @map("id_card_type")
  primaryRole                                 user_primary_role?  @map("primary_role")
  status                                      user_status?
  ekycVerified                                Int?                @map("ekyc_verified") @default(0)
  token                                       String?             @db.VarChar(1024)
  expirationDate                              DateTime?           @map("expiration_date") @db.Timestamptz(6)
  resetPasswordOTP                            String?             @map("reset_password_otp") @db.VarChar(1024)
  resetPasswordOTPExpirationDate              DateTime?           @map("reset_password_otp_expiration_date") @db.Timestamptz(6)
  lastActive                                  DateTime?           @map("last_active") @default(now()) @db.Timestamptz(6)
  agentCertificate                            String?             @map("agent_certificate")
  agentStatus                                 String?             @map("agent_status") @db.VarChar(50)
  idCardDocuments                             Json?               @map("id_card_documents")
  avatar                                      String?
  idCardPlaceIfIssue                          String?             @map("id_card_place_if_issue") @db.VarChar(256)
  idCardIssueDate                             DateTime?           @map("id_card_issue_date") @db.Timestamptz(6)
  balance                                     Float?
  lifetimeBalance                             Float?              @map("lifetime_balance")
  createdAt                                   DateTime?           @map("created_at") @default(now()) @db.Timestamptz(6)
  updatedAt                                   DateTime?           @map("updated_at") @default(now()) @db.Timestamptz(6)
  Appointment                                 Appointment[]
  Audit                                       Audit[]
  ChatRoom                                    ChatRoom[]
  Comment                                     Comment[]
  Device                                      Device[]
  Document                                    Document[]
  Favorite                                    Favorite[]
  Feedback                                    Feedback[]
  Lead                                        Lead[]
  Listing                                     Listing[]
  Media                                       Media[]
  Member                                      Member[]
  Message                                     Message[]
  News                                        News[]
  Notification                                Notification[]
  OTP                                         OTP[]
  Panorama                                    Panorama[]
  Payment                                     Payment[]
  Property_Property_authorized_agent_idToUser Property[]          @relation("Property_authorized_agent_idToUser")
  Property_Property_authorized_user_idToUser  Property[]          @relation("Property_authorized_user_idToUser")
  Property_Property_user_idToUser             Property[]          @relation("Property_user_idToUser")
  Subscription                                Subscription[]
  Transaction_Transaction_agent_idToUser      Transaction[]       @relation("Transaction_agent_idToUser")
  Transaction_Transaction_guest_idToUser      Transaction[]       @relation("Transaction_guest_idToUser")
  Transaction_Transaction_seller_idToUser     Transaction[]       @relation("Transaction_seller_idToUser")
  WalletTransaction                           WalletTransaction[]

  @@map("User")
}

model Appointment {
  id            BigInt              @id @default(autoincrement())
  property_id   BigInt
  user_id       BigInt
  listing_id    BigInt
  status        appointment_status? @default(PENDING)
  datetime      DateTime            @db.Timestamptz(6)
  description   String?
  cancel_reason String?
  address       String?
  created_at    DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?           @default(now()) @db.Timestamptz(6)
  Listing       Listing             @relation(fields: [listing_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Property      Property            @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User          User                @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Area {
  id          BigInt    @id @default(autoincrement())
  name        String    @db.VarChar(255)
  type        area_type
  parent_id   BigInt?
  latitude    Float?
  longitude   Float?
  is_old_area Int?      @default(0)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  Area        Area?     @relation("AreaToArea", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  other_Area  Area[]    @relation("AreaToArea")
}

model Audit {
  id          BigInt       @id @default(autoincrement())
  object_id   BigInt
  object_type String       @db.VarChar(50)
  action      audit_action
  user_id     BigInt
  timestamp   DateTime     @db.Timestamptz(6)
  details     Json?
  created_at  DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?    @default(now()) @db.Timestamptz(6)
  User        User         @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Building {
  id               BigInt       @id @default(autoincrement())
  project_id       BigInt?
  subdivision_id   BigInt?
  name             String       @db.VarChar(255)
  address          String?      @db.VarChar(255)
  num_floors       Int?
  num_units        Int?
  approximate_area Decimal?     @db.Decimal(10, 2)
  units_per_floor  Int?
  num_basements    Int?
  description      String?
  images           Json?
  created_at       DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?    @default(now()) @db.Timestamptz(6)
  Project          Project?     @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Subdivision      Subdivision? @relation(fields: [subdivision_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Media            Media[]
  Panorama         Panorama[]
}

model Category {
  id             BigInt     @id @default(autoincrement())
  name           String     @db.VarChar(255)
  description    String?
  parent_id      BigInt?
  created_at     DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?  @default(now()) @db.Timestamptz(6)
  Category       Category?  @relation("CategoryToCategory", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  other_Category Category[] @relation("CategoryToCategory")
}

model ChatRoom {
  id              BigInt    @id @default(autoincrement())
  listing_id      BigInt?
  is_active       Boolean?  @default(true)
  members_count   Int?      @default(0)
  last_message_id BigInt?
  last_message_at DateTime? @db.Timestamptz(6)
  created_by      BigInt
  created_at      DateTime? @default(now()) @db.Timestamptz(6)
  updated_at      DateTime? @default(now()) @db.Timestamptz(6)
  User            User      @relation(fields: [created_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Comment {
  id         BigInt    @id @default(autoincrement())
  news_id    BigInt?
  content    String?
  user_id    BigInt?
  status     String?   @db.VarChar(20)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  News       News?     @relation(fields: [news_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User       User?     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Config {
  id          BigInt    @id @default(autoincrement())
  key         String    @db.VarChar(255)
  value       String
  platform    String?   @db.VarChar(20)
  public      Int?      @default(1)
  description String?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
}

model Device {
  id             BigInt    @id @default(autoincrement())
  user_id        BigInt
  uuid           String    @db.VarChar(256)
  platform       String?   @db.VarChar(256)
  platform_token String?   @db.VarChar(2048)
  online         Int?      @default(0)
  granted        Int?      @default(0)
  ip_address     String?   @db.VarChar(256)
  created_at     DateTime? @default(now()) @db.Timestamptz(6)
  updated_at     DateTime? @default(now()) @db.Timestamptz(6)
  User           User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Document {
  id          BigInt               @id @default(autoincrement())
  project_id  BigInt?
  property_id BigInt?
  title       String               @db.VarChar(255)
  description String?
  url         String               @db.VarChar(500)
  path        String?              @db.VarChar(500)
  type        document_type?
  legal_type  document_legal_type?
  user_id     BigInt
  created_at  DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?            @default(now()) @db.Timestamptz(6)
  Project     Project?             @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Property    Property?            @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User        User                 @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model FAQ {
  id         BigInt        @id @default(autoincrement())
  question   String        @db.VarChar(255)
  answer     String
  project_id BigInt?
  category   faq_category?
  status     faq_status    @default(ACTIVE)
  order      Int           @default(0)
  created_at DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at DateTime?     @default(now()) @db.Timestamptz(6)
  Project    Project?      @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Favorite {
  id          BigInt    @id @default(autoincrement())
  type        String?   @default("LISTING") @db.VarChar(20)
  user_id     BigInt
  property_id BigInt?
  listing_id  BigInt?
  news_id     BigInt?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  Property    Property? @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User        User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Feedback {
  id         BigInt    @id @default(autoincrement())
  user_id    BigInt
  content    String
  rating     Int?
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  User       User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Investor {
  id          BigInt    @id @default(autoincrement())
  name        String    @db.VarChar(255)
  address     String?   @db.VarChar(255)
  phone       String?   @db.VarChar(20)
  email       String?   @db.VarChar(255)
  website     String?   @db.VarChar(255)
  description String?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
}

model Lead {
  id          BigInt       @id @default(autoincrement())
  email       String?      @db.VarChar(255)
  phone       String?      @db.VarChar(20)
  source      String?      @db.VarChar(100)
  project_id  BigInt?
  status      lead_status? @default(NEW)
  assigned_to BigInt?
  notes       String?
  fullname    String?      @db.VarChar(255)
  created_at  DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?    @default(now()) @db.Timestamptz(6)
  User        User?        @relation(fields: [assigned_to], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Project     Project?     @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Listing {
  id               BigInt          @id @default(autoincrement())
  property_id      BigInt
  user_id          BigInt
  title            String          @db.VarChar(255)
  description      String?
  price            Decimal         @db.Decimal(15, 2)
  listing_type     listing_type?
  status           listing_status? @default(PENDING)
  created_at       DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?       @default(now()) @db.Timestamptz(6)
  verified         Int?            @default(0)
  expiration_date  DateTime?       @db.Timestamptz(6)
  currency         String?         @default("VND") @db.VarChar(10)
  listing_messages Json?
  is_featured      Int             @default(0)
  views            Int?            @default(0)
  priority         Int
  pushed_date      DateTime        @db.Timestamptz(6)
  credit_source    String?         @db.VarChar(50)
  push_count       Int             @default(0)
  push_remain      Int?            @default(0)
  title_ai         String?         @db.VarChar(255)
  description_ai   String?
  Appointment      Appointment[]
  Property         Property        @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User             User            @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Payment          Payment[]
  Transaction      Transaction[]
}

model ListingPrice {
  id               BigInt                  @id @default(autoincrement())
  priority         Int                     @default(0)
  price            Float
  price_before_tax Float
  tax_rate         Float
  description      String?
  duration_days    Int
  push_count       Int                     @default(0)
  currency         listing_price_currency? @default(VND)
  created_at       DateTime?               @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?               @default(now()) @db.Timestamptz(6)
}

model Media {
  id             BigInt       @id @default(autoincrement())
  property_id    BigInt?
  project_id     BigInt?
  building_id    BigInt?
  subdivision_id BigInt?
  type           media_type
  url            String       @db.VarChar(500)
  path           String?      @db.VarChar(500)
  order          Int?         @default(0)
  user_id        BigInt
  created_at     DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?    @default(now()) @db.Timestamptz(6)
  Building       Building?    @relation(fields: [building_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Project        Project?     @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Property       Property?    @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Subdivision    Subdivision? @relation(fields: [subdivision_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User           User         @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Member {
  id           BigInt    @id @default(autoincrement())
  user_id      BigInt
  room_id      BigInt
  role         String?   @db.VarChar(256)
  status       String?   @db.VarChar(50)
  notification Int?      @default(1)
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @db.Timestamptz(6)
  User         User      @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Message {
  id           BigInt        @id @default(autoincrement())
  room_id      BigInt
  sender_id    BigInt
  content      String
  message_type message_type? @default(TEXT)
  is_read      Boolean?      @default(false)
  media        String?
  metadata     Json?
  created_at   DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?     @default(now()) @db.Timestamptz(6)
  User         User          @relation(fields: [sender_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model News {
  id             BigInt       @id @default(autoincrement())
  category_id    BigInt?
  title          String       @db.VarChar(255)
  content        String
  user_id        BigInt?
  published_date DateTime?    @db.Timestamptz(6)
  status         news_status?
  author         String?      @db.VarChar(100)
  source_url     String?      @db.VarChar(2048)
  source         String?      @db.VarChar(2048)
  project_id     BigInt?
  tags           Json?
  views          Int          @default(0)
  created_at     DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?    @default(now()) @db.Timestamptz(6)
  Comment        Comment[]
  Project        Project?     @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User           User?        @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Notification {
  id         BigInt             @id @default(autoincrement())
  user_id    BigInt?
  title      String             @db.VarChar(255)
  content    String
  type       notification_type?
  public     Int?               @default(1)
  is_read    Boolean?           @default(false)
  created_at DateTime?          @default(now()) @db.Timestamptz(6)
  updated_at DateTime?          @default(now()) @db.Timestamptz(6)
  User       User?              @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model OTP {
  id          BigInt      @id @default(autoincrement())
  channel     otp_channel
  from        String?     @db.VarChar(100)
  destination String?     @db.VarChar(255)
  code        String      @db.VarChar(10)
  purpose     otp_purpose
  expires_at  DateTime    @db.Timestamptz(6)
  delivered   Boolean?    @default(false)
  user_id     BigInt?
  created_at  DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?   @default(now()) @db.Timestamptz(6)
  User        User?       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Panorama {
  id             BigInt       @id @default(autoincrement())
  user_id        BigInt
  property_id    BigInt?
  project_id     BigInt?
  building_id    BigInt?
  subdivision_id BigInt?
  base_url       String?      @db.VarChar(1024)
  base_path      String?      @db.VarChar(2048)
  order          Int?         @default(0)
  location       String?      @db.VarChar(1024)
  latitude       Float?
  longitude      Float?
  created_at     DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?    @default(now()) @db.Timestamptz(6)
  Building       Building?    @relation(fields: [building_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Project        Project?     @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Property       Property?    @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Subdivision    Subdivision? @relation(fields: [subdivision_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User           User         @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Payment {
  id                      BigInt          @id @default(autoincrement())
  subscription_id         BigInt?
  amount                  Float
  payment_method          payment_method
  payment_status          payment_status? @default(PENDING)
  user_id                 BigInt
  tax_rate                Float           @default(0)
  amount_before_tax       Float?
  description             String?
  time                    DateTime        @db.Timestamptz(6)
  payment_link            String?
  qr_code                 String?
  external_transaction_id String?         @db.VarChar(1024)
  payment_for             String?         @db.VarChar(50)
  wallet_transaction_id   BigInt?
  listing_id              BigInt?
  created_at              DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at              DateTime?       @default(now()) @db.Timestamptz(6)
  Listing                 Listing?        @relation(fields: [listing_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Subscription            Subscription?   @relation(fields: [subscription_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User                    User            @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Plan {
  id                BigInt         @id @default(autoincrement())
  name              String         @db.VarChar(255)
  description       String?
  price             Float
  duration_days     Int
  max_listings      Int            @default(1)
  featured_listings Int?           @default(0)
  priority_support  Boolean        @default(false)
  status            plan_status    @default(ACTIVE)
  created_at        DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?      @default(now()) @db.Timestamptz(6)
  Subscription      Subscription[]
}

model PriceHistory {
  id          BigInt    @id @default(autoincrement())
  property_id BigInt
  price       Decimal   @db.Decimal(15, 2)
  change_date DateTime  @db.Timestamptz(6)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  Property    Property  @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Project {
  id               BigInt        @id @default(autoincrement())
  name             String        @db.VarChar(255)
  investor_id      BigInt?
  scale            Decimal?      @db.Decimal(10, 2)
  density          String?       @db.VarChar(100)
  num_blocks       Int?
  description      String?
  start_date       DateTime?     @db.Date
  end_date         DateTime?     @db.Date
  status           String?       @default("UPDATING") @db.VarChar(50)
  project_type     String?       @db.VarChar(100)
  primary_media_id BigInt?
  area_p_id        Int?
  area_w_id        Int?
  old_area_p_id    Int?
  old_area_d_id    Int?
  old_area_w_id    Int?
  premise_image    String?
  created_at       DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?     @default(now()) @db.Timestamptz(6)
  Building         Building[]
  Document         Document[]
  FAQ              FAQ[]
  Lead             Lead[]
  Media            Media[]
  News             News[]
  Panorama         Panorama[]
  Subdivision      Subdivision[]
  Utility          Utility[]
}

model Property {
  id                                      BigInt                 @id @default(autoincrement())
  user_id                                 BigInt?
  authorized_user_id                      BigInt?
  authorized_agent_id                     BigInt?
  project_id                              BigInt?
  building_id                             BigInt?
  subdivision_id                          BigInt?
  address                                 String
  title                                   String                 @db.VarChar(255)
  floor                                   Int?
  unit                                    String?                @db.VarChar(64)
  description                             String?
  property_type                           property_type?
  width                                   Decimal?               @db.Decimal(5, 2)
  length                                  Decimal?               @db.Decimal(5, 2)
  floors                                  Int?
  floor_area                              Decimal?               @db.Decimal(10, 2)
  building_area                           Decimal?               @db.Decimal(10, 2)
  land_area                               Decimal?               @db.Decimal(10, 2)
  bedrooms                                Int?
  toilets                                 Int?
  status                                  property_status?
  direction                               property_direction?
  legal_document_type                     property_legal_type?
  legal_document_number                   String?                @db.VarChar(64)
  legal_status                            property_legal_status?
  latitude                                Decimal?               @db.Decimal(10, 8)
  longitude                               Decimal?               @db.Decimal(11, 8)
  furniture                               property_furniture?
  street_width                            Decimal?               @db.Decimal(5, 2)
  primary_media_id                        BigInt?
  usage_status                            property_usage_status? @default(OWNER_OCCUPIED)
  area_p_id                               Int?
  area_w_id                               Int?
  old_area_p_id                           Int?
  old_area_d_id                           Int?
  old_area_w_id                           Int?
  panorama_config                         Json?
  created_at                              DateTime?              @default(now()) @db.Timestamptz(6)
  updated_at                              DateTime?              @default(now()) @db.Timestamptz(6)
  Appointment                             Appointment[]
  Document                                Document[]
  Favorite                                Favorite[]
  Listing                                 Listing[]
  Media                                   Media[]
  Panorama                                Panorama[]
  PriceHistory                            PriceHistory[]
  User_Property_authorized_agent_idToUser User?                  @relation("Property_authorized_agent_idToUser", fields: [authorized_agent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User_Property_authorized_user_idToUser  User?                  @relation("Property_authorized_user_idToUser", fields: [authorized_user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User_Property_user_idToUser             User?                  @relation("Property_user_idToUser", fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Transaction                             Transaction[]
}

model Subdivision {
  id          BigInt     @id @default(autoincrement())
  project_id  BigInt?
  name        String     @db.VarChar(255)
  description String?
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?  @default(now()) @db.Timestamptz(6)
  Building    Building[]
  Media       Media[]
  Panorama    Panorama[]
  Project     Project?   @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Subscription {
  id                  BigInt               @id @default(autoincrement())
  user_id             BigInt
  plan_id             BigInt
  start_date          DateTime             @db.Timestamptz(6)
  end_date            DateTime             @db.Timestamptz(6)
  status              subscription_status? @default(ACTIVE)
  payment_status      payment_status?      @default(PENDING)
  gold_listing_used   Int                  @default(0)
  silver_listing_used Int                  @default(0)
  normal_listing_used Int                  @default(0)
  push_count_used     Int                  @default(0)
  created_at          DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?            @default(now()) @db.Timestamptz(6)
  Payment             Payment[]
  Plan                Plan                 @relation(fields: [plan_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User                User                 @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Suggestion {
  id             BigInt          @id @default(autoincrement())
  text           String
  type           suggestion_type
  matched_count  Int             @default(0)
  foreign_key_id BigInt?
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
}

model Transaction {
  id                               BigInt              @id @default(autoincrement())
  listing_id                       BigInt
  agent_id                         BigInt?
  seller_id                        BigInt
  guest_id                         BigInt?
  transaction_date                 DateTime            @db.Timestamptz(6)
  price                            Float
  status                           transaction_status? @default(OFFERED)
  effective_date                   DateTime?           @db.Timestamptz(6)
  expiration_date                  DateTime?           @db.Timestamptz(6)
  contract_document                String?
  property_id                      BigInt
  created_at                       DateTime?           @default(now()) @db.Timestamptz(6)
  updated_at                       DateTime?           @default(now()) @db.Timestamptz(6)
  User_Transaction_agent_idToUser  User?               @relation("Transaction_agent_idToUser", fields: [agent_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User_Transaction_guest_idToUser  User?               @relation("Transaction_guest_idToUser", fields: [guest_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Listing                          Listing             @relation(fields: [listing_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  Property                         Property            @relation(fields: [property_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  User_Transaction_seller_idToUser User                @relation("Transaction_seller_idToUser", fields: [seller_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model Utility {
  id          BigInt    @id @default(autoincrement())
  project_id  BigInt?
  name        String    @db.VarChar(255)
  type        String?   @db.VarChar(50)
  description String?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  Project     Project?  @relation(fields: [project_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model WalletTransaction {
  id             BigInt          @id @default(autoincrement())
  user_id        BigInt
  amount         Float
  ending_balance Float
  payment_method payment_method
  status         payment_status? @default(PENDING)
  description    String?
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  User           User            @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

enum appointment_status {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum area_type {
  C
  P
  D
  W
}

enum audit_action {
  CREATE
  UPDATE
  DELETE
}

enum document_legal_type {
  SO_HONG
  HDMB
  OTHER
}

enum document_type {
  PDF
  DOCX
  IMAGE
  OTHER
}

enum faq_category {
  PLAN
  PROJECT
  PAYMENT
  ACCOUNT
}

enum faq_status {
  ACTIVE
  INACTIVE
}

enum lead_status {
  NEW
  CONTACTED
  QUALIFIED
  LOST
}

enum listing_price_currency {
  VND
  USD
}

enum listing_status {
  PENDING
  REVIEWING
  ACTIVE
  INACTIVE
  SOLD
  RENTED
  EXPIRED
  REJECTED
}

enum listing_type {
  FOR_SALE
  FOR_RENT
}

enum media_type {
  IMAGE
  VIDEO
  D        @map("3D")
  PANORAMA
}

enum message_type {
  TEXT
  IMAGE
  VIDEO
  FILE
}

enum news_status {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum notification_type {
  NEWS
  SYSTEM
  PROMOTION
  TRANSACTION
  APPOINTMENT
  LISTING
  PROJECT
  PROPERTY
}

enum otp_channel {
  SMS
  EMAIL
  ZALO
}

enum otp_purpose {
  REGISTER
  LOGIN
  TRANSACTION
  CHANGE_PASSWORD
}

enum payment_method {
  CASH
  VNPAY
  MOMO
  QR
}

enum payment_status {
  PENDING
  COMPLETED
  FAILED
}

enum plan_status {
  ACTIVE
  INACTIVE
}

enum property_direction {
  NORTH
  SOUTH
  EAST
  WEST
  NORTHEAST
  SOUTHEAST
  NORTHWEST
  SOUTHWEST
}

enum property_furniture {
  BASIC
  FULL
  NONE
}

enum property_legal_status {
  LEGAL
  PLANNING_ISSUES
  UNDETERMINED
  REVOKED
  NON_EXISTENT
}

enum property_legal_type {
  SO_HONG
  HDMB
  OTHER
}

enum property_status {
  DRAFT
  PENDING
  REVIEWING
  APPROVED
  REJECTED
}

enum property_type {
  APARTMENT
  MINI_APARTMENT
  HOUSE
  VILLA
  STREETFRONT
  COMMERCIAL
  LAND_PROJECT
  LAND_SALE
  CONDOTEL
  WAREHOUSE
  OTHER
}

enum property_usage_status {
  OWNER_OCCUPIED
  FOR_RENT
  RENTED
}

enum subscription_status {
  ACTIVE
  EXPIRED
  CANCELLED
}

enum suggestion_type {
  PROPERTY
  LISTING
  PROJECT
  AREA
  NEWS
  OTHER
}

enum transaction_status {
  OFFERED
  ACCEPTED
  COMPLETED
  CANCELLED
}

enum user_idcard_type {
  CC
  PASSPORT
}

enum user_primary_role {
  USER
  AGENT
  ADMIN
}

enum user_status {
  REGISTERED
  ACTIVE
  BANNED
  DELETED
}
